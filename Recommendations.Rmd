---
title: "People"
output: html_document
date: "2025-05-14"
---
# Linear Models
## Libraries
```{r}
library(tidyverse)
library(olsrr)
```
## Load Data
```{r}
lc <- read_csv("lyrics_combined.csv")
df <- read_csv("df.csv")
```
```{r}
theme_vars <- c(
  "crush_theme", "empowerment_theme", "exes_theme", "forbidden_love_theme", 
  "grief_theme", "growing_up_theme", "growth_theme", "happy_theme", "hate_theme", 
  "heartbreak_theme", "jealousy_theme", "love_theme", "mental_health_theme", 
  "moving_on_theme", "partying_theme", "rebellion_theme", "religion_theme", 
  "reminiscing_theme", "revenge_theme", "situationship_theme", 
  "toxic_relationship_theme", "unrequited_theme"
)

prep_theme_df <- function(df, theme_name, theme_vars) {
  # Pull the theme column separately to ensure it's preserved
  target_theme_col <- dplyr::select(df, all_of(theme_name))

  # Get numeric predictors, remove other theme variables
  df_numeric <- df %>%
    dplyr::select(where(is.numeric)) %>%
    dplyr::select(where(~ sum(., na.rm = TRUE) > 15)) %>%
    dplyr::select(-any_of(setdiff(theme_vars, theme_name)))

  # Combine predictors with the target theme column
  df_clean <- dplyr::bind_cols(df_numeric, target_theme_col) %>%
    tidyr::drop_na(all_of(theme_name))

  return(df_clean)
}

theme_dfs <- lapply(theme_vars, function(theme) {
  prep_theme_df(df_num_full, theme, theme_vars)
})

```


